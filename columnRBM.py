from rbm import RBM
import numpy as np

# Initialization of RBM
simple_rbm = RBM(num_visible = 20, num_hidden = 12)

# Data used
simple_group_train =np.array([[1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
                              [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0],
                              [1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],
                              [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
                              [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0],
                              [0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0],
                              [1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],
                              [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
                              [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0],
                              [1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
                              [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],
                              [0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0]])

outlier_data_point = np.array([1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1])

# Training the model
simple_rbm.train(simple_group_train, max_epochs = 5000)
print("Done training")

# Generate data
print("Daydream")
print(simple_rbm.daydream(20))

